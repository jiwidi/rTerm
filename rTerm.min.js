rTerm=function(a){return this.file=a.file,this.divid=a.div||'rterm',this.username=a.username||'user',this.hostname=a.hostname||'hostname',this.fsstart=a.fsstart||'/home/'+this.username,this.height=a.height||400,this.maxStrings=a.maxStrings||15,this.saveStrings=a.saveStrings||!1,this.loggerAppPort=a.loggerAppPort||9091,this.chartime=250,this.cdir=this.fsstart,this.uhsername=this.username+'@'+this.hostname,this.data={},this.clicked=!1,this.init=function(){$.getJSON(this.file,function(b){this.data=b,'undefined'!==this.data.upstart&&this.callUpstart(),$(document).keypress(this.keyCallback),$(document).keydown(this.specKeyCallback)}.bind(this)),$('#'+this.divid).html('<div id="term"> <span id="termcli">'+this.termPrev+'</span><span class="cursor">&#9608</span></div>')},this.termPrev='<b>'+this.uhsername+'</b>:~$  ',this.oldInput='',this.input='',this.nStrings=0,this.callUpstart=function(){var b=0;for(cid in this.upcid=0,this.data.upstart)0<cid&&(b+=(this.data.upstart[cid-1].length+1)*this.chartime),setTimeout(function(){this.enterCommand(this.data.upstart[this.upcid]),this.upcid++},b)},this.enterCommand=function(b){this.currlid=0;var c=[];for(lid in b)c.push(this.chartime*(lid-0.25+0.5*Math.random()));for(lid in c[0]=0,b)setTimeout(function(){this.addCallback(b[this.currlid]),this.currlid++},this.chartime*lid);setTimeout(function(){this.enterCallback()},this.chartime*b.length)},this.updateTerm=function(){for($('#termcli').html(this.oldInput+this.termPrev+this.input);$('#term').height()>this.height;)this.delFristString(),$('#termcli').html(this.oldInput+this.termPrev+this.input)},this.delFristString=function(){var b=this.oldInput.indexOf('<br>');this.oldInput=this.oldInput.slice(b+4,-4)+'<br>',this.nStrings--},this.specKeyCallback=function(b){8==b.which||46==b.which||110==b.which?this.delCallback():13==b.which&&this.enterCallback()}.bind(this),this.keyCallback=function(b){13!=b.which&&this.addCallback(String.fromCharCode(b.keyCode))}.bind(this),this.addCallback=function(b){this.input+=b,this.updateTerm()}.bind(this),this.delCallback=function(){this.input=this.input.slice(0,-1),this.updateTerm()}.bind(this),this.enterCallback=function(){if(''==this.input)this.emptyCallback();else{this.saveStrings&&this.sendString(this.input);var b=this.input.split(' ');b[0]in this.funcMap?this.funcMap[b[0]](b):this.unknownCallback()}}.bind(this),this.emptyCallback=function(){this.oldInput+=this.termPrev+this.input+'<br>',this.nStrings++,this.updateTerm()}.bind(this),this.unknownCallback=function(){this.oldInput+=this.termPrev+this.input+'<br>'+this.input+': command not found<br>',this.input='',this.nStrings+=2,this.updateTerm()}.bind(this),this.sendString=function(b){var c=new XMLHttpRequest;c.open('POST','https://'+window.location.hostname+':'+this.loggerAppPort,!0),c.send(b)}.bind(this),this.getByPath=function(b){var c='';c=b.startsWith('/')?b:b.startsWith('~')?this.fsstart+'/'+b.slice(1):this.cdir+'/'+b,c.endsWith('/')&&(c=c.slice(0,-1));var d=c.split('/').slice(1),e=[];for(i in d)'..'==d[i]?e.splice(-1,1):e.push(d[i]);c='/'+e.join('/');var f=this.data.fs;for(folder of e)f=f[folder];return[f,c]}.bind(this),this.lsCallback=function(b){this.oldInput+=this.termPrev+this.input+'<br>',this.nStrings++;var c=!1,d=!1,e=this.cdir;for(arg of b.slice(1))arg.startsWith('-')?'-a'==arg?c=!0:'-l'==arg&&(d=!0):e=arg.startsWith('/')?arg:e+'/'+arg;var f=this.getByPath(e)[0];if('undefined'==typeof f)this.oldInput+='ls: cannot access \''+e+'\': No such file or directory<br>',this.nStrings++;else for(item in f)(!item.startsWith('.')||c)&&(this.oldInput+='string'==typeof f[item]?f[item].startsWith('_link:')?'<a class="link" href="'+f[item].slice(6)+'" target="_blank">'+item+'</a><br>':item+'<br>':'<font color="#729FCF">'+item+'</font><br>',this.nStrings++);this.input='',this.updateTerm()}.bind(this),this.catCallback=function(b){var c=this.getByPath(b[1])[0];if(''==c||'undefined'==typeof c)this.oldInput+=this.termPrev+this.input+'<br>'+this.input+': No such file or directory<br>';else if(c.startsWith('_call:')){var b=c.slice(6).split(' ');if(b[0]in this.funcMap)return void this.funcMap[b[0]](b);this.oldInput+=this.termPrev+this.input+'<br>'+c+'<br>'}else this.oldInput+=this.termPrev+this.input+'<br>'+c+'<br>';this.input='',this.nStrings+=2,this.updateTerm()}.bind(this),this.cdCallback=function(b){var c='';c=2>b.length||' '==b[1]?'~':b[1];var[d,e]=this.getByPath(c);if('undefined'==typeof d)this.oldInput+=this.termPrev+this.input+'<br>'+this.input+': No such file or directory<br>',this.input='',this.nStrings+=2;else if('string'==typeof d)d.startsWith('_link:')?(this.oldInput+=this.termPrev+this.input+'<br>',this.input='',this.nStrings++,window.open(d.slice(6),'_blank').focus()):(this.oldInput+=this.termPrev+this.input+'<br>'+this.input+': Not a directory<br>',this.input='',this.nStrings+=2);else if('object'==typeof d){this.cdir=e,this.oldInput+=this.termPrev+this.input+'<br>',this.input='',this.nStrings++;var f=this.cdir;f==this.fsstart&&(f='~'),this.termPrev='<b>'+this.uhsername+'</b>:'+f+'$  '}this.updateTerm()}.bind(this),this.pwdCallback=function(){this.oldInput+=this.termPrev+this.input+'<br>'+this.cdir+'<br>',this.input='',this.nStrings+=2,this.updateTerm()}.bind(this),this.whoamiCallback=function(){this.oldInput+=this.termPrev+this.input+'<br>',this.nStrings++;for(item of this.data.whoami)this.oldInput+=item+'<br>',this.nStrings++;this.input='',this.updateTerm()}.bind(this),this.unameCallback=function(){this.oldInput+=this.termPrev+this.input+'<br>'+this.data.uname+'<br>',this.input='',this.nStrings+=2,this.updateTerm()}.bind(this),this.randomCallback=function(){this.oldInput+=this.termPrev+this.input+'<br>'+(Math.random()+'<br>'),this.input='',this.nStrings+=2,this.updateTerm()}.bind(this),this.idkCallback=function(){for(item in this.oldInput+=this.termPrev+this.input+'<br>',this.nStrings++,this.funcMap)this.oldInput+=item+'<br>',this.nStrings++;this.input='',this.updateTerm()}.bind(this),this.funcMap={ls:this.lsCallback,cd:this.cdCallback,cat:this.catCallback,whoami:this.whoamiCallback,uname:this.unameCallback,idk:this.idkCallback,help:this.idkCallback,random:this.randomCallback,pwd:this.pwdCallback},this.init(),this};